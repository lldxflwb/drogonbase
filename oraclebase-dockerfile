FROM gcc:11.3.0
EXPOSE 8080
EXPOSE 22
RUN apt-get update && \
    apt-get install git gdb cmake make \
    libjsoncpp-dev uuid-dev openssl \
    libssl-dev zlib1g-dev libboost-dev \
    postgresql-all openssh-server \
    vim rpm libaio-dev alien rsync \
    libboost-dev libboost-filesystem-dev \
    libboost-iostreams-dev libboost-program-options-dev \
    libboost-system-dev -y  
# compile the protocl
RUN curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash && \
    source /root/.bashrc && \ 
    nvm install v12.22.12 && \
    git clone https://github.com/confluentinc/avro-cpp-packaging && \
    cd avro-cpp-packaging && mkdir build && cd build && \
    cmake -G "Unix Makefiles" .. && make -j8 && make install && \
    # install protcol
    cd ../.. && git clone https://bitbucket.org/energistics/etp-cpp.git && \ 
    cd etp-cpp && cd build && cmake .. && make -j8 && make install 
